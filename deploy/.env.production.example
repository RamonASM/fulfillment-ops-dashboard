# =============================================================================
# INVENTORY INTELLIGENCE PLATFORM - Production Environment Configuration
# =============================================================================
# Copy this file to .env in the deploy directory for Docker deployments
# Or to root directory for PM2/traditional deployments
# =============================================================================

# =============================================================================
# DEPLOYMENT MODE
# =============================================================================
NODE_ENV=production
DEPLOYMENT_MODE=docker  # docker, pm2, or traditional

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================
# PostgreSQL connection settings
DB_USER=inventory
DB_PASSWORD=CHANGE_THIS_SECURE_PASSWORD_NOW
DB_NAME=inventory_db
DB_HOST=localhost  # Use 'postgres' for Docker
DB_PORT=5432

# Full database URL (auto-constructed or override)
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}?schema=public

# =============================================================================
# REDIS CONFIGURATION
# =============================================================================
# Cache and session store
REDIS_HOST=localhost  # Use 'redis' for Docker
REDIS_PORT=6379
REDIS_PASSWORD=  # Leave empty for no password, set for production
REDIS_URL=redis://${REDIS_PASSWORD:+:${REDIS_PASSWORD}@}${REDIS_HOST}:${REDIS_PORT}

# =============================================================================
# API SERVER CONFIGURATION
# =============================================================================
API_PORT=3001
API_URL=https://api.yourtechassist.us

# Domain URLs
WEB_URL=https://admin.yourtechassist.us
PORTAL_URL=https://portal.yourtechassist.us

# CORS allowed origins (comma-separated)
CORS_ORIGINS=https://admin.yourtechassist.us,https://portal.yourtechassist.us

# =============================================================================
# SECURITY - JWT & SESSION
# =============================================================================
# Generate secure secrets with: openssl rand -base64 32

# JWT for access tokens (expires in 15min-1hour)
JWT_SECRET=GENERATE_SECURE_SECRET_HERE_32_CHARS_MIN
JWT_EXPIRES_IN=15m

# JWT for refresh tokens (expires in 7-30 days)
JWT_REFRESH_SECRET=GENERATE_DIFFERENT_SECRET_HERE_32_CHARS_MIN
JWT_REFRESH_EXPIRES_IN=7d

# Session secret for cookie signing
SESSION_SECRET=GENERATE_THIRD_SECRET_HERE_32_CHARS_MIN

# Cookie settings
COOKIE_DOMAIN=.yourtechassist.us
COOKIE_SECURE=true  # Must be true for HTTPS
COOKIE_SAME_SITE=lax

# =============================================================================
# ML ANALYTICS SERVICE
# =============================================================================
ML_ANALYTICS_URL=http://ml-analytics:8000  # Docker internal URL
ML_PORT=8000

# =============================================================================
# EMAIL / SMTP CONFIGURATION
# =============================================================================
# Email service (optional but recommended for password resets, notifications)

# SMTP server settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false  # true for 465, false for 587
SMTP_USER=your-email@gmail.com
SMTP_PASS=your-app-specific-password

# Sender information
EMAIL_FROM_NAME=Inventory Intelligence
EMAIL_FROM_ADDRESS=noreply@yourtechassist.us

# Email features
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_PASSWORD_RESET=true

# =============================================================================
# AI FEATURES (OPTIONAL)
# =============================================================================
# Enable AI-powered insights, summaries, and analysis

# Anthropic Claude API (recommended)
ANTHROPIC_API_KEY=sk-ant-api03-...
ANTHROPIC_MODEL=claude-3-5-sonnet-20241022

# OpenAI API (alternative)
OPENAI_API_KEY=sk-...
OPENAI_MODEL=gpt-4-turbo-preview

# AI feature flags
ENABLE_AI_INSIGHTS=true
ENABLE_AI_SUMMARIES=true
ENABLE_AI_CHAT=false

# =============================================================================
# FILE STORAGE CONFIGURATION
# =============================================================================
# Storage backend: local, s3, or azure
STORAGE_TYPE=local

# Local storage (default)
UPLOAD_DIR=/app/uploads
MAX_FILE_SIZE=52428800  # 50MB in bytes

# AWS S3 (if STORAGE_TYPE=s3)
S3_BUCKET=inventory-uploads
S3_REGION=us-east-1
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=

# Azure Blob Storage (if STORAGE_TYPE=azure)
AZURE_STORAGE_ACCOUNT=
AZURE_STORAGE_KEY=
AZURE_CONTAINER=inventory-uploads

# =============================================================================
# MONITORING & LOGGING
# =============================================================================
# Logging configuration
LOG_LEVEL=info  # debug, info, warn, error
LOG_FORMAT=json  # json or pretty
LOG_FILE=/var/log/inventory/api.log

# Sentry error tracking (optional)
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# Performance monitoring
ENABLE_PERFORMANCE_MONITORING=true
ENABLE_REQUEST_LOGGING=true

# =============================================================================
# RATE LIMITING
# =============================================================================
# API rate limiting configuration
RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
RATE_LIMIT_MAX_REQUESTS=100  # Max requests per window
RATE_LIMIT_LOGIN_MAX=5  # Max login attempts per window

# =============================================================================
# BACKUP CONFIGURATION
# =============================================================================
# Database backup settings
BACKUP_ENABLED=true
BACKUP_DIR=/backups
BACKUP_KEEP_DAYS=7
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM (cron format)

# =============================================================================
# FEATURE FLAGS
# =============================================================================
# Enable/disable platform features
ENABLE_CLIENT_PORTAL=true
ENABLE_IMPORTS=true
ENABLE_EXPORTS=true
ENABLE_ANALYTICS_DASHBOARD=true
ENABLE_REAL_TIME_UPDATES=true  # WebSocket support

# =============================================================================
# THIRD-PARTY INTEGRATIONS (OPTIONAL)
# =============================================================================
# QuickBooks integration
QUICKBOOKS_CLIENT_ID=
QUICKBOOKS_CLIENT_SECRET=
QUICKBOOKS_REDIRECT_URI=

# Slack notifications
SLACK_WEBHOOK_URL=
SLACK_CHANNEL=#inventory-alerts

# Twilio SMS (for alerts)
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_PHONE_NUMBER=

# =============================================================================
# ADVANCED SETTINGS
# =============================================================================
# Worker/Job Queue settings
ENABLE_BACKGROUND_JOBS=true
QUEUE_CONCURRENCY=5

# Database connection pool
DB_POOL_MIN=2
DB_POOL_MAX=10

# Request timeout settings
REQUEST_TIMEOUT=30000  # 30 seconds
LONG_REQUEST_TIMEOUT=300000  # 5 minutes for reports/exports

# Cache TTL (Time To Live)
CACHE_TTL=3600  # 1 hour in seconds
CACHE_CHECK_PERIOD=600  # 10 minutes

# =============================================================================
# DEVELOPMENT/DEBUG (Set to false in production)
# =============================================================================
DEBUG=false
ENABLE_PLAYGROUND=false
ENABLE_GRAPHIQL=false
PRETTY_ERRORS=false

# =============================================================================
# SECURITY HEADERS
# =============================================================================
HSTS_MAX_AGE=31536000  # 1 year
ENABLE_CORS=true
ENABLE_HELMET=true
TRUST_PROXY=true  # Set true if behind nginx/load balancer

# =============================================================================
# NOTES:
# =============================================================================
# 1. Never commit this file with real secrets to version control
# 2. Use strong, unique passwords for all services
# 3. Generate JWT secrets with: openssl rand -base64 32
# 4. For Docker deployments, adjust hostnames (localhost -> service names)
# 5. Enable HTTPS in production (COOKIE_SECURE=true)
# 6. Review and adjust rate limits based on your traffic
# 7. Set up database backups before going live
# 8. Configure email for password reset functionality
# 9. Enable monitoring/logging in production
# 10. Test configuration in staging before production deployment
# =============================================================================
